import{u as x,c as n,a as t,t as i,k as a,e as h,b as u,h as w,r as g,g as v,o as d,A as y}from"./index-r35W0lTO.js";import{B as _}from"./BottomNav-BAYLEPWZ.js";import k from"./FaceScanner-CD5LhS-o.js";const S={class:"min-h-screen bg-slate-50 flex flex-col pb-24"},C={class:"bg-[#84a96b] p-6 text-white flex items-center gap-4 shadow-md"},E={class:"p-6 flex-1 flex flex-col items-center"},N={class:"mt-8 flex flex-col items-center"},$={class:"relative group"},B={class:"w-32 h-32 bg-white rounded-full overflow-hidden border-4 border-[#84a96b] shadow-xl"},j=["src"],A={class:"mt-4 text-xl font-bold text-slate-800"},O={class:"text-slate-500 text-sm"},P={class:"w-full mt-10 bg-white rounded-3xl p-6 shadow-sm border border-slate-100 mb-6"},R={class:"flex items-center justify-between mb-4"},V={key:0,class:"text-[10px] bg-green-100 text-green-600 px-2 py-1 rounded-full font-bold uppercase"},D={key:1,class:"text-[10px] bg-amber-100 text-amber-600 px-2 py-1 rounded-full font-bold uppercase"},L={__name:"ProfileView",setup(I){const s=x(),f=v(),l=g(!1),p=w(()=>`https://ui-avatars.com/api/?name=${s.user.name}&background=84a96b&color=fff&size=128`),b=()=>{alert("Profile photo upload will be available in the next update!")},m=async o=>{l.value=!1;try{const e=await fetch(`${y}/api/enroll-face`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({student_id:s.user.student_id,face_descriptor:o})});if(e.ok)alert("Success! Your face is now registered."),s.user.face_descriptor=JSON.stringify(o),await s.updateFaceDescriptor(JSON.stringify(o));else{const r=await e.json();alert("Enrollment failed: "+(r.error||"Server error"))}}catch(e){console.error("Enrollment Error:",e),alert("Network Error: Could not reach the server to save face data.")}},c=async()=>{confirm("Are you sure you want to log out?")&&(await s.logout(),f.push("/"))};return(o,e)=>(d(),n("div",S,[t("div",C,[t("button",{onClick:e[0]||(e[0]=r=>o.$router.back()),class:"p-1"},[...e[3]||(e[3]=[t("i",{class:"fas fa-arrow-left text-xl"},null,-1)])]),e[4]||(e[4]=t("h1",{class:"text-xl font-bold"},"My Profile",-1))]),t("div",E,[t("div",N,[t("div",$,[t("div",B,[t("img",{src:p.value,class:"w-full h-full object-cover"},null,8,j)]),t("button",{onClick:b,class:"absolute bottom-0 right-0 bg-[#84a96b] text-white p-2 rounded-full border-2 border-white shadow-md"},[...e[5]||(e[5]=[t("i",{class:"fas fa-camera text-sm"},null,-1)])])]),t("h2",A,i(a(s).user.name),1),t("p",O,i(a(s).user.student_id),1)]),t("div",P,[t("div",R,[e[6]||(e[6]=t("h3",{class:"font-bold text-slate-800"},"Security",-1)),a(s).user.face_descriptor?(d(),n("span",V," Enrolled ")):(d(),n("span",D," Not Registered "))]),e[8]||(e[8]=t("p",{class:"text-sm text-slate-500 mb-4"},"Register your face to enable high-speed check-in at the school entrance.",-1)),t("button",{onClick:e[1]||(e[1]=r=>l.value=!0),class:"w-full bg-[#2d74da] text-white font-bold py-3 rounded-xl flex items-center justify-center gap-2 active:scale-95 transition-all"},[e[7]||(e[7]=t("i",{class:"fas fa-user-astronaut"},null,-1)),h(" "+i(a(s).user.face_descriptor?"Update Face Data":"Register Face"),1)])]),t("div",{class:"w-full space-y-4"},[t("button",{onClick:c,class:"w-full bg-[#e55353] hover:bg-red-600 text-white font-bold py-4 rounded-2xl shadow-lg shadow-red-100 active:scale-[0.98] transition-all"}," Log Out "),t("button",{onClick:c,class:"w-full bg-white border border-slate-200 text-slate-700 font-bold py-4 rounded-2xl shadow-sm active:scale-[0.98] transition-all"}," Switch Account ")]),e[9]||(e[9]=t("div",{class:"w-full mt-6 p-4 bg-slate-100 rounded-2xl"},[t("p",{class:"text-xs text-slate-500 text-center italic"}," To change your password or update your student ID, please contact the administrator at CK School. ")],-1))]),u(k,{show:l.value,onClose:e[2]||(e[2]=r=>l.value=!1),onVerified:m,mode:"enroll"},null,8,["show"]),u(_)]))}};export{L as default};
